Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_probs_dropout_prob=0.5, batch_size=256, cuda_condition=True, data_dir='./data/', data_file='./data/Beauty.txt', data_name='Beauty', do_eval=False, epochs=200, full_sort=True, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, item_size=12102, load_model=None, log_file='output/FMLPRec-Beauty-Oct-25-2025_17-22-06.txt', log_freq=1, lr=0.001, max_seq_length=50, model_name='FMLPRec', no_cuda=False, no_filters=False, num_attention_heads=2, num_hidden_layers=2, output_dir='output/', patience=10, sample_file='./data/Beauty_sample.txt', seed=42, variance=5, weight_decay=0.0)
Total Parameters: 851200
{'epoch': 0, 'rec_loss': '1.2387'}
{'Epoch': 0, 'HIT@5': '0.0093', 'NDCG@5': '0.0057', 'HIT@10': '0.0160', 'NDCG@10': '0.0079', 'HIT@20': '0.0299', 'NDCG@20': '0.0114'}
Validation score increased.  Saving model ...
{'epoch': 1, 'rec_loss': '1.1062'}
{'Epoch': 1, 'HIT@5': '0.0129', 'NDCG@5': '0.0086', 'HIT@10': '0.0216', 'NDCG@10': '0.0114', 'HIT@20': '0.0348', 'NDCG@20': '0.0147'}
Validation score increased.  Saving model ...
{'epoch': 2, 'rec_loss': '1.0185'}
{'Epoch': 2, 'HIT@5': '0.0169', 'NDCG@5': '0.0105', 'HIT@10': '0.0291', 'NDCG@10': '0.0144', 'HIT@20': '0.0471', 'NDCG@20': '0.0189'}
Validation score increased.  Saving model ...
{'epoch': 3, 'rec_loss': '0.9447'}
{'Epoch': 3, 'HIT@5': '0.0198', 'NDCG@5': '0.0122', 'HIT@10': '0.0351', 'NDCG@10': '0.0171', 'HIT@20': '0.0546', 'NDCG@20': '0.0220'}
Validation score increased.  Saving model ...
{'epoch': 4, 'rec_loss': '0.8782'}
{'Epoch': 4, 'HIT@5': '0.0244', 'NDCG@5': '0.0152', 'HIT@10': '0.0415', 'NDCG@10': '0.0207', 'HIT@20': '0.0618', 'NDCG@20': '0.0258'}
Validation score increased.  Saving model ...
{'epoch': 5, 'rec_loss': '0.8253'}
{'Epoch': 5, 'HIT@5': '0.0260', 'NDCG@5': '0.0161', 'HIT@10': '0.0429', 'NDCG@10': '0.0215', 'HIT@20': '0.0712', 'NDCG@20': '0.0286'}
Validation score increased.  Saving model ...
{'epoch': 6, 'rec_loss': '0.7791'}
{'Epoch': 6, 'HIT@5': '0.0310', 'NDCG@5': '0.0200', 'HIT@10': '0.0516', 'NDCG@10': '0.0267', 'HIT@20': '0.0786', 'NDCG@20': '0.0334'}
Validation score increased.  Saving model ...
{'epoch': 7, 'rec_loss': '0.7425'}
{'Epoch': 7, 'HIT@5': '0.0326', 'NDCG@5': '0.0206', 'HIT@10': '0.0521', 'NDCG@10': '0.0269', 'HIT@20': '0.0828', 'NDCG@20': '0.0345'}
Validation score increased.  Saving model ...
{'epoch': 8, 'rec_loss': '0.7143'}
{'Epoch': 8, 'HIT@5': '0.0350', 'NDCG@5': '0.0220', 'HIT@10': '0.0552', 'NDCG@10': '0.0285', 'HIT@20': '0.0862', 'NDCG@20': '0.0363'}
Validation score increased.  Saving model ...
{'epoch': 9, 'rec_loss': '0.6875'}
{'Epoch': 9, 'HIT@5': '0.0350', 'NDCG@5': '0.0221', 'HIT@10': '0.0571', 'NDCG@10': '0.0292', 'HIT@20': '0.0890', 'NDCG@20': '0.0372'}
Validation score increased.  Saving model ...
{'epoch': 10, 'rec_loss': '0.6656'}
{'Epoch': 10, 'HIT@5': '0.0350', 'NDCG@5': '0.0221', 'HIT@10': '0.0589', 'NDCG@10': '0.0298', 'HIT@20': '0.0913', 'NDCG@20': '0.0380'}
Validation score increased.  Saving model ...
{'epoch': 11, 'rec_loss': '0.6490'}
{'Epoch': 11, 'HIT@5': '0.0357', 'NDCG@5': '0.0222', 'HIT@10': '0.0604', 'NDCG@10': '0.0301', 'HIT@20': '0.0946', 'NDCG@20': '0.0387'}
Validation score increased.  Saving model ...
{'epoch': 12, 'rec_loss': '0.6300'}
{'Epoch': 12, 'HIT@5': '0.0402', 'NDCG@5': '0.0245', 'HIT@10': '0.0628', 'NDCG@10': '0.0318', 'HIT@20': '0.0937', 'NDCG@20': '0.0396'}
Validation score increased.  Saving model ...
{'epoch': 13, 'rec_loss': '0.6158'}
{'Epoch': 13, 'HIT@5': '0.0397', 'NDCG@5': '0.0251', 'HIT@10': '0.0663', 'NDCG@10': '0.0336', 'HIT@20': '0.0987', 'NDCG@20': '0.0418'}
Validation score increased.  Saving model ...
{'epoch': 14, 'rec_loss': '0.6091'}
{'Epoch': 14, 'HIT@5': '0.0392', 'NDCG@5': '0.0252', 'HIT@10': '0.0632', 'NDCG@10': '0.0329', 'HIT@20': '0.0990', 'NDCG@20': '0.0420'}
Validation score increased.  Saving model ...
{'epoch': 15, 'rec_loss': '0.5968'}
{'Epoch': 15, 'HIT@5': '0.0406', 'NDCG@5': '0.0258', 'HIT@10': '0.0671', 'NDCG@10': '0.0344', 'HIT@20': '0.1002', 'NDCG@20': '0.0426'}
Validation score increased.  Saving model ...
{'epoch': 16, 'rec_loss': '0.5859'}
{'Epoch': 16, 'HIT@5': '0.0419', 'NDCG@5': '0.0269', 'HIT@10': '0.0649', 'NDCG@10': '0.0344', 'HIT@20': '0.0977', 'NDCG@20': '0.0426'}
EarlyStopping counter: 1 out of 10
{'epoch': 17, 'rec_loss': '0.5765'}
{'Epoch': 17, 'HIT@5': '0.0419', 'NDCG@5': '0.0274', 'HIT@10': '0.0658', 'NDCG@10': '0.0351', 'HIT@20': '0.1010', 'NDCG@20': '0.0439'}
Validation score increased.  Saving model ...
{'epoch': 18, 'rec_loss': '0.5682'}
{'Epoch': 18, 'HIT@5': '0.0403', 'NDCG@5': '0.0258', 'HIT@10': '0.0641', 'NDCG@10': '0.0334', 'HIT@20': '0.0994', 'NDCG@20': '0.0423'}
EarlyStopping counter: 1 out of 10
{'epoch': 19, 'rec_loss': '0.5615'}
{'Epoch': 19, 'HIT@5': '0.0415', 'NDCG@5': '0.0265', 'HIT@10': '0.0664', 'NDCG@10': '0.0345', 'HIT@20': '0.0994', 'NDCG@20': '0.0427'}
EarlyStopping counter: 2 out of 10
{'epoch': 20, 'rec_loss': '0.5541'}
{'Epoch': 20, 'HIT@5': '0.0423', 'NDCG@5': '0.0268', 'HIT@10': '0.0688', 'NDCG@10': '0.0353', 'HIT@20': '0.1043', 'NDCG@20': '0.0442'}
Validation score increased.  Saving model ...
{'epoch': 21, 'rec_loss': '0.5491'}
{'Epoch': 21, 'HIT@5': '0.0410', 'NDCG@5': '0.0266', 'HIT@10': '0.0647', 'NDCG@10': '0.0342', 'HIT@20': '0.1016', 'NDCG@20': '0.0434'}
EarlyStopping counter: 1 out of 10
{'epoch': 22, 'rec_loss': '0.5476'}
{'Epoch': 22, 'HIT@5': '0.0428', 'NDCG@5': '0.0275', 'HIT@10': '0.0670', 'NDCG@10': '0.0352', 'HIT@20': '0.1026', 'NDCG@20': '0.0442'}
EarlyStopping counter: 2 out of 10
{'epoch': 23, 'rec_loss': '0.5446'}
{'Epoch': 23, 'HIT@5': '0.0403', 'NDCG@5': '0.0259', 'HIT@10': '0.0637', 'NDCG@10': '0.0334', 'HIT@20': '0.1016', 'NDCG@20': '0.0429'}
EarlyStopping counter: 3 out of 10
{'epoch': 24, 'rec_loss': '0.5351'}
{'Epoch': 24, 'HIT@5': '0.0461', 'NDCG@5': '0.0295', 'HIT@10': '0.0698', 'NDCG@10': '0.0371', 'HIT@20': '0.1041', 'NDCG@20': '0.0457'}
Validation score increased.  Saving model ...
{'epoch': 25, 'rec_loss': '0.5319'}
{'Epoch': 25, 'HIT@5': '0.0450', 'NDCG@5': '0.0290', 'HIT@10': '0.0703', 'NDCG@10': '0.0372', 'HIT@20': '0.1080', 'NDCG@20': '0.0467'}
Validation score increased.  Saving model ...
{'epoch': 26, 'rec_loss': '0.5271'}
{'Epoch': 26, 'HIT@5': '0.0447', 'NDCG@5': '0.0289', 'HIT@10': '0.0715', 'NDCG@10': '0.0375', 'HIT@20': '0.1058', 'NDCG@20': '0.0461'}
EarlyStopping counter: 1 out of 10
{'epoch': 27, 'rec_loss': '0.5264'}
{'Epoch': 27, 'HIT@5': '0.0436', 'NDCG@5': '0.0285', 'HIT@10': '0.0675', 'NDCG@10': '0.0362', 'HIT@20': '0.1050', 'NDCG@20': '0.0457'}
EarlyStopping counter: 2 out of 10
{'epoch': 28, 'rec_loss': '0.5161'}
{'Epoch': 28, 'HIT@5': '0.0460', 'NDCG@5': '0.0297', 'HIT@10': '0.0698', 'NDCG@10': '0.0373', 'HIT@20': '0.1088', 'NDCG@20': '0.0471'}
Validation score increased.  Saving model ...
{'epoch': 29, 'rec_loss': '0.5133'}
{'Epoch': 29, 'HIT@5': '0.0449', 'NDCG@5': '0.0293', 'HIT@10': '0.0688', 'NDCG@10': '0.0370', 'HIT@20': '0.1053', 'NDCG@20': '0.0461'}
EarlyStopping counter: 1 out of 10
{'epoch': 30, 'rec_loss': '0.5102'}
{'Epoch': 30, 'HIT@5': '0.0414', 'NDCG@5': '0.0273', 'HIT@10': '0.0663', 'NDCG@10': '0.0353', 'HIT@20': '0.1042', 'NDCG@20': '0.0448'}
EarlyStopping counter: 2 out of 10
{'epoch': 31, 'rec_loss': '0.5107'}
{'Epoch': 31, 'HIT@5': '0.0447', 'NDCG@5': '0.0286', 'HIT@10': '0.0707', 'NDCG@10': '0.0369', 'HIT@20': '0.1084', 'NDCG@20': '0.0464'}
EarlyStopping counter: 3 out of 10
{'epoch': 32, 'rec_loss': '0.5052'}
{'Epoch': 32, 'HIT@5': '0.0446', 'NDCG@5': '0.0286', 'HIT@10': '0.0726', 'NDCG@10': '0.0375', 'HIT@20': '0.1091', 'NDCG@20': '0.0468'}
EarlyStopping counter: 4 out of 10
{'epoch': 33, 'rec_loss': '0.5000'}
{'Epoch': 33, 'HIT@5': '0.0419', 'NDCG@5': '0.0268', 'HIT@10': '0.0695', 'NDCG@10': '0.0358', 'HIT@20': '0.1058', 'NDCG@20': '0.0449'}
EarlyStopping counter: 5 out of 10
{'epoch': 34, 'rec_loss': '0.4977'}
{'Epoch': 34, 'HIT@5': '0.0439', 'NDCG@5': '0.0284', 'HIT@10': '0.0696', 'NDCG@10': '0.0366', 'HIT@20': '0.1058', 'NDCG@20': '0.0458'}
EarlyStopping counter: 6 out of 10
{'epoch': 35, 'rec_loss': '0.4977'}
{'Epoch': 35, 'HIT@5': '0.0436', 'NDCG@5': '0.0289', 'HIT@10': '0.0699', 'NDCG@10': '0.0373', 'HIT@20': '0.1069', 'NDCG@20': '0.0466'}
EarlyStopping counter: 7 out of 10
{'epoch': 36, 'rec_loss': '0.4946'}
{'Epoch': 36, 'HIT@5': '0.0487', 'NDCG@5': '0.0305', 'HIT@10': '0.0747', 'NDCG@10': '0.0389', 'HIT@20': '0.1088', 'NDCG@20': '0.0475'}
Validation score increased.  Saving model ...
{'epoch': 37, 'rec_loss': '0.4892'}
{'Epoch': 37, 'HIT@5': '0.0462', 'NDCG@5': '0.0304', 'HIT@10': '0.0726', 'NDCG@10': '0.0388', 'HIT@20': '0.1086', 'NDCG@20': '0.0479'}
Validation score increased.  Saving model ...
{'epoch': 38, 'rec_loss': '0.4913'}
{'Epoch': 38, 'HIT@5': '0.0455', 'NDCG@5': '0.0297', 'HIT@10': '0.0730', 'NDCG@10': '0.0385', 'HIT@20': '0.1102', 'NDCG@20': '0.0478'}
EarlyStopping counter: 1 out of 10
{'epoch': 39, 'rec_loss': '0.4838'}
{'Epoch': 39, 'HIT@5': '0.0466', 'NDCG@5': '0.0306', 'HIT@10': '0.0718', 'NDCG@10': '0.0386', 'HIT@20': '0.1069', 'NDCG@20': '0.0475'}
EarlyStopping counter: 2 out of 10
{'epoch': 40, 'rec_loss': '0.4855'}
{'Epoch': 40, 'HIT@5': '0.0449', 'NDCG@5': '0.0295', 'HIT@10': '0.0705', 'NDCG@10': '0.0377', 'HIT@20': '0.1076', 'NDCG@20': '0.0470'}
EarlyStopping counter: 3 out of 10
{'epoch': 41, 'rec_loss': '0.4827'}
{'Epoch': 41, 'HIT@5': '0.0451', 'NDCG@5': '0.0301', 'HIT@10': '0.0702', 'NDCG@10': '0.0382', 'HIT@20': '0.1067', 'NDCG@20': '0.0474'}
EarlyStopping counter: 4 out of 10
{'epoch': 42, 'rec_loss': '0.4807'}
{'Epoch': 42, 'HIT@5': '0.0427', 'NDCG@5': '0.0280', 'HIT@10': '0.0656', 'NDCG@10': '0.0354', 'HIT@20': '0.1048', 'NDCG@20': '0.0453'}
EarlyStopping counter: 5 out of 10
{'epoch': 43, 'rec_loss': '0.4797'}
{'Epoch': 43, 'HIT@5': '0.0448', 'NDCG@5': '0.0305', 'HIT@10': '0.0689', 'NDCG@10': '0.0382', 'HIT@20': '0.1044', 'NDCG@20': '0.0471'}
EarlyStopping counter: 6 out of 10
{'epoch': 44, 'rec_loss': '0.4758'}
{'Epoch': 44, 'HIT@5': '0.0450', 'NDCG@5': '0.0302', 'HIT@10': '0.0694', 'NDCG@10': '0.0380', 'HIT@20': '0.1066', 'NDCG@20': '0.0473'}
EarlyStopping counter: 7 out of 10
{'epoch': 45, 'rec_loss': '0.4729'}
{'Epoch': 45, 'HIT@5': '0.0471', 'NDCG@5': '0.0309', 'HIT@10': '0.0710', 'NDCG@10': '0.0385', 'HIT@20': '0.1071', 'NDCG@20': '0.0476'}
EarlyStopping counter: 8 out of 10
{'epoch': 46, 'rec_loss': '0.4727'}
{'Epoch': 46, 'HIT@5': '0.0460', 'NDCG@5': '0.0304', 'HIT@10': '0.0709', 'NDCG@10': '0.0383', 'HIT@20': '0.1068', 'NDCG@20': '0.0474'}
EarlyStopping counter: 9 out of 10
{'epoch': 47, 'rec_loss': '0.4716'}
{'Epoch': 47, 'HIT@5': '0.0425', 'NDCG@5': '0.0278', 'HIT@10': '0.0665', 'NDCG@10': '0.0355', 'HIT@20': '0.1062', 'NDCG@20': '0.0455'}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Sample 99 results---------------
{'Epoch': 0, 'HIT@5': '0.0335', 'NDCG@5': '0.0215', 'HIT@10': '0.0541', 'NDCG@10': '0.0281', 'HIT@20': '0.0842', 'NDCG@20': '0.0356'}
FMLPRec-Beauty-Oct-25-2025_17-22-06
{'Epoch': 0, 'HIT@5': '0.0335', 'NDCG@5': '0.0215', 'HIT@10': '0.0541', 'NDCG@10': '0.0281', 'HIT@20': '0.0842', 'NDCG@20': '0.0356'}
